"use strict";(self["webpackChunkweweb_front"]=self["webpackChunkweweb_front"]||[]).push([[2646],{2646:(e,t,i)=>{i.r(t),i.d(t,{default:()=>b});var s=i(6252);const l={class:"flex items-center"},a={key:0,class:"body-2 text-error mb-2"},n={class:"flex items-center"},o={key:1,class:"body-2 text-error mb-2"};function r(e,t,i,r,d,u){const c=(0,s.up)("wwEditorInputTextSelect"),b=(0,s.up)("wwEditorIcon"),p=(0,s.up)("wwEditorFormRow"),m=(0,s.up)("wwLoader");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(p,{label:"Role table"},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.Wm)(c,{class:"w-100",placeholder:"Select a table","model-value":i.settings.publicData.roleTable,options:u.tablesOptions,"onUpdate:modelValue":t[0]||(t[0]=e=>u.changePrivateSettings("roleTable",e))},null,8,["model-value","options"]),(0,s._)("button",{type:"button",class:"ww-editor-button -primary -small -icon ml-2",onClick:t[1]||(t[1]=(...e)=>u.fetchTables&&u.fetchTables(...e))},[(0,s.Wm)(b,{name:"refresh",medium:""})])])])),_:1}),i.settings.publicData.roleTable&&!u.isRoleTableValid?((0,s.wg)(),(0,s.iD)("div",a,' Table must have columns "id" and "name". ')):(0,s.kq)("",!0),(0,s.Wm)(p,{label:"User role table"},{default:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s.Wm)(c,{class:"w-100",placeholder:"Select a table","model-value":i.settings.publicData.userRoleTable,options:u.tablesOptions,"onUpdate:modelValue":t[2]||(t[2]=e=>u.changePrivateSettings("userRoleTable",e))},null,8,["model-value","options"]),(0,s._)("button",{type:"button",class:"ww-editor-button -primary -small -icon ml-2",onClick:t[3]||(t[3]=(...e)=>u.fetchTables&&u.fetchTables(...e))},[(0,s.Wm)(b,{name:"refresh",medium:""})])])])),_:1}),i.settings.publicData.userRoleTable&&!u.isUserRoleTableValid?((0,s.wg)(),(0,s.iD)("div",o,' Table must have column "id", "roleId" and "userId". ')):(0,s.kq)("",!0),(0,s.Wm)(m,{loading:d.isLoading},null,8,["loading"])],64)}var d={props:{plugin:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:settings"],data(){return{isLoading:!1,definitions:{}}},computed:{tablesOptions(){return[{label:"None",value:null},...Object.keys(this.definitions).map((e=>({label:e,value:e})))]},isRoleTableValid(){const e=this.definitions[this.settings.publicData.roleTable];if(!e)return!1;const t=Object.keys(e.properties);return t.includes("id")&&t.includes("name")},isUserRoleTableValid(){const e=this.definitions[this.settings.publicData.userRoleTable];if(!e)return!1;const t=Object.keys(e.properties);return t.includes("id")&&t.includes("roleId")&&t.includes("userId")}},mounted(){this.definitions=this.plugin.doc.definitions||{}},methods:{async fetchTables(){try{this.isLoading=!0,await this.plugin.fetchDoc(),this.definitions=this.plugin.doc.definitions||{}}catch(e){wwLib.wwLog.error(e)}finally{this.isLoading=!1}},changePrivateSettings(e,t){this.$emit("update:settings",{...this.settings,publicData:{...this.settings.publicData,[e]:t}})}}},u=i(3744);const c=(0,u.Z)(d,[["render",r],["__scopeId","data-v-68497f09"]]);var b=c}}]);